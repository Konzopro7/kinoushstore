{% extends "core/base.html" %}







{% load static %}







{% block title %}Suivi de commande - Kinoush Store{% endblock %}
{% block meta_robots %}noindex, nofollow{% endblock %}















{% block content %}







<div class="container py-5" style="max-width: 980px;">







  <h1 class="h4 mb-4">Suivi de commande</h1>















  <form method="post" class="card p-4 shadow-sm border-0 mb-4" style="max-width: 720px;">







    {% csrf_token %}







    <div class="row g-3">







      <div class="col-md-6">







        <label class="form-label">Référence</label>







        <input class="form-control" name="reference" placeholder="Ex: KNS-2025-0001" required>





      </div>







      <div class="col-md-6">







        <label class="form-label">Email</label>







        <input class="form-control" type="email" name="email" placeholder="client@gmail.com" required>







      </div>







      <div class="col-12">







        <button class="btn btn-dark w-100">Rechercher</button>







      </div>







    </div>







  </form>















  {% if order %}







    <!-- Résumé commande -->







    <div class="card p-4 shadow-sm border-0 mb-4">







      <div class="d-flex flex-wrap justify-content-between align-items-center gap-2">







        <div>







          <div class="text-muted small">Référence</div>







          <div class="fw-bold">{{ order.reference }}</div>







        </div>















        <div>







          <div class="text-muted small">Statut</div>







          <span class="badge







            {% if order.status == 'paid' %}bg-success







            {% elif order.status == 'pending' %}bg-warning text-dark







            {% elif order.status == 'shipped' %}bg-primary







            {% elif order.status == 'delivered' %}bg-dark







            {% else %}bg-danger{% endif %}







          ">







            {{ order.get_status_display }}







          </span>







        </div>















        <div class="text-end">







          <div class="text-muted small">Client</div>







          <div class="fw-semibold">{{ order.first_name }} {{ order.last_name }}</div>







          <div class="small text-muted">{{ order.email }}</div>







        </div>







      </div>















      <hr class="my-4">















      <div class="row g-3">







        <div class="col-md-6">







          <div class="text-muted small">Adresse</div>







          <div class="fw-semibold">{{ order.address }}</div>







          <div class="text-muted">{{ order.city }}</div>







        </div>







        <div class="col-md-6">







          <div class="text-muted small">Dates</div>







          <div>Crée : <span class="fw-semibold">{{ order.created_at|date:"d/m/Y H:i" }}</span></div>







          {% if order.paid_at %}







            <div>Payée : <span class="fw-semibold">{{ order.paid_at|date:"d/m/Y H:i" }}</span></div>







          {% endif %}







        </div>







      </div>







    </div>















    <!-- Produits -->







    <h2 class="h5 mb-3">Articles</h2>







    <div class="table-responsive">







      <table class="table align-middle">







        <thead>







          <tr>







            <th>Produit</th>







            <th class="text-center">Qté</th>







            <th class="text-end">Prix</th>







            <th class="text-end">Total</th>







          </tr>







        </thead>







        <tbody>







          {% for it in items %}







            <tr>







              <td>







                <div class="d-flex align-items-center gap-3">







                  {% if it.image %}







                    <img src="{{ it.image }}" alt="{{ it.title }}" style="width:60px;height:60px;object-fit:cover;border-radius:10px;">







                  {% else %}







                    <div style="width:60px;height:60px;border-radius:10px;background:#f1f1f1;"></div>







                  {% endif %}







                  <div class="fw-semibold">{{ it.title }}</div>







                </div>







              </td>







              <td class="text-center">{{ it.quantity }}</td>







              <td class="text-end">{{ it.price }} $</td>







              <td class="text-end">{{ it.line_total }} $</td>







            </tr>







          {% endfor %}







        </tbody>







      </table>







    </div>















    <div class="d-flex justify-content-end mt-3">







      <div class="card p-3 border-0 shadow-sm" style="min-width: 260px;">







        <div class="d-flex justify-content-between">
          <span>Sous-total</span>
          <span>{{ subtotal|floatformat:2 }} $</span>
        </div>
        <div class="d-flex justify-content-between">
          <span>Frais de livraison</span>
          <span>{{ shipping_fee|floatformat:2 }} $</span>
        </div>
        <div class="d-flex justify-content-between fw-bold mt-2">
          <span>Total</span>
          <span>{{ total|floatformat:2 }} $</span>
        </div>







      </div>







    </div>















    <div class="mt-4 d-flex gap-2">







      <a href="{% url 'shop:product_list' %}" class="btn btn-dark">Retour à la boutique</a>







      <a href="{% url 'shop:home' %}" class="btn btn-outline-secondary">Accueil</a>







    </div>







  {% endif %}







</div>







{% endblock %}















